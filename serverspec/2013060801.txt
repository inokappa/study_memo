# serverspec と jenkis で簡易的にサーバーを監視してみた

## 概要

 * serverspec を定期的に実行することでサーバーの監視が出来るんぢゃないかと思い試してみた

## メリット・デメリット

ということで serverspec と jenkins を組み合わせたサーバー監視のメリットとデメリットについて考えてみた。

### メリット

 * サーバー、クライアント共に小難しい監視システムを構築する手間が省ける
 * ssh のポートが空いていれば監視出来る（監視システム用のポートを考慮する必要が無い）
 * クライアント側からの push 監視も可能（cron の結果を post で受け取る）
 * 意外に手軽

### デメリット

 * jenkins ユーザーでのログインを許可するなどセキュリティのリスクが増える
 * リソース監視は不可能では無いが手間が増える
 * 残念ながらグラフとか書けない

ぶっちゃげ、`Zabbix` や `Nagios` の方が良いと思われるが、メリットにもある通り手軽にサービスの監視が出来るという点では serverspec と jenkins という組み合わせも悪くないのではと考えている。

## 準備

今回試す環境は `CentOS 5.9` に jenkins と serverspec をインストールして環境を構築する。

### トポロジ

以下のような構成となる。

### jenkins のインストール

### ruby をソースコードからインストール

ソースからインストールすると見た目はインストールに成功するが、`gem` を叩くと大体 `zlib` と `openssl` あたりではまる。`CentOS`  だと `zlib-devel`  と `openssl-devel` を `yum install` した後でソースコードのディレクトリに移動して…

```
cd ${path_to}_ruby/ext/zlib/
ruby 
```

### serverspec のインストール

```
/usr/local/bin/gem install serverspec --no-ri --no-rdoc
```