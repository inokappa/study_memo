# serverspec を実際の運用でどのように使うかを考えてみた

## 概要

 * [前回](http://inokara.hateblo.jp/entry/2013/06/02/011833) redis サーバーをインストールしたホストを serverspec を使ってテストしてみた
 * ということで、今回は serverspec を運用でどのように使うかをとある仮想の現場を題材に考えてみる

## 参考

今回は下記を参考にさせて頂きました。

 * [http://serverspec.org/](http://serverspec.org/)
 * [serverspecでZabbixサーバの稼働テストを書いてみた](http://d.hatena.ne.jp/ike-dai/20130514/1368534178)
  
## serverspec についての認識

 * [こちら](http://mizzy.org/blog/2013/03/23/1/)に書かれているようにサーバー上で稼働しているサービスや開いているポート等をテストするツール
 * 対象となるホストに対して SSH でアクセスするので物理サーバーでも仮想サーバーでもテストが可能

## 実際の運用（現場について）

実際に serverspec を利用することを想定した仮想現場の状況ついて整理してみる。これらを元に後ほど

### サーバーで使っている OS

 * CentOS

### サーバーパーティションの状態

 * / パーティション以外に /boot が存在すること

### サーバーの詳細設定

 * ホスト名は `ahoaho.inokara.com` となっていること
 * selinux は `disabled` となっていること

### サーバー上で稼働しているべきサービス

 * SSH（ただしポートは 22222 番ポート）
 * postfix
 * Apache（ポート 80 番で稼働しており、ServerName は `ahoaho.inokara.com` となっていること）
 * MySQL（ただしポートは 3306 番〜 3310 番）

### サーバー上で稼働するべきではないサービス

 * iptables


## テストを書く



## まとめ

 * serverspec を使うことでホストのあるべき状態をテストすることが出来た
 * cookbook のテストというよりもサーバー設定そのものをテストするツールとして幅広く運用を考えていきたい！
